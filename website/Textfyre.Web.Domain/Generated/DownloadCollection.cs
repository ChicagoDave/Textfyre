/*
 *  DO NOT EDIT THIS CLASS.
 * 
 *  This class is generated by a tool and should not be edited. If you need to change the functionality of 
 *  this class, you should discuss your changes with the team and they should be implemented in the
 *  appropriate template.
 *  
 */
using System;
using System.Data;
using System.Configuration;
using System.Collections.Generic;
using Textfyre.Common.BusinessLayer;

namespace Textfyre.TextfyreWeb.BusinessLayer {

    /// <summary>
    /// Collection class for Download domain class.
    /// </summary>
    [Serializable()]
    public class DownloadCollection : List<Textfyre.TextfyreWeb.BusinessLayer.Download> {
        /// <summary>
        /// Flag identifies when collection has been modified (updated record, added record, deleted record).
        /// </summary>
        private bool _isCollectionDirty;
        /// <summary>
        /// Public property for _isCollectionDirty.
        /// </summary>
        public bool IsCollectionDirty { get { return _isCollectionDirty; } set { _isCollectionDirty = value; } }

        /// <summary>
        /// Add method to add a new record to the collection by passing a domain object.
        /// </summary>
        new public void Add(Textfyre.TextfyreWeb.BusinessLayer.Download Download) {
            base.Add(Download);
            _isCollectionDirty = true;
        }

        /// <summary>
        /// Add method to add a new record to the collection by passing a recordset.
        /// </summary>
        public void Add(Textfyre.TextfyreWeb.BusinessLayer.DownloadRecordset recordset) {
            this.Add(new Download(recordset));
        }

        /// <summary>
        /// Remove method to remove a record from the collection by passing a domain object.
        /// </summary>
        new public void Remove(Textfyre.TextfyreWeb.BusinessLayer.Download Download) {
            base.Remove(Download);
            _isCollectionDirty = true;
        }

        /// <summary>
        /// Fill a recordset with cloned objects from internal recordset.
        /// </summary>
        public void Fill(List<Textfyre.TextfyreWeb.BusinessLayer.DownloadRecordset> DownloadRecs) {
            this.Clear();            
            foreach (Textfyre.TextfyreWeb.BusinessLayer.DownloadRecordset rec in DownloadRecs)
                Add((Textfyre.TextfyreWeb.BusinessLayer.DownloadRecordset)rec.Clone());
        }

        public void Sort(Textfyre.TextfyreWeb.DataLayer.DownloadFields sortField, SortDirection sortDirection)
        {
            switch (sortField)
            {
				case DataLayer.DownloadFields.DownloadId:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.DownloadIdColumnDESC);
					else
						Sort(Download.SortBy.DownloadIdColumnASC);
					break;
				case DataLayer.DownloadFields.ProductId:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.ProductIdColumnDESC);
					else
						Sort(Download.SortBy.ProductIdColumnASC);
					break;
				case DataLayer.DownloadFields.PlatformId:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.PlatformIdColumnDESC);
					else
						Sort(Download.SortBy.PlatformIdColumnASC);
					break;
				case DataLayer.DownloadFields.Version:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.VersionColumnDESC);
					else
						Sort(Download.SortBy.VersionColumnASC);
					break;
				case DataLayer.DownloadFields.AvailableDate:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.AvailableDateColumnDESC);
					else
						Sort(Download.SortBy.AvailableDateColumnASC);
					break;
				case DataLayer.DownloadFields.IsLocked:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.IsLockedColumnDESC);
					else
						Sort(Download.SortBy.IsLockedColumnASC);
					break;
				case DataLayer.DownloadFields.IntelMac:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.IntelMacColumnDESC);
					else
						Sort(Download.SortBy.IntelMacColumnASC);
					break;
				case DataLayer.DownloadFields.PowerPCMac:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.PowerPCMacColumnDESC);
					else
						Sort(Download.SortBy.PowerPCMacColumnASC);
					break;
				case DataLayer.DownloadFields.WindowsXP:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.WindowsXPColumnDESC);
					else
						Sort(Download.SortBy.WindowsXPColumnASC);
					break;
				case DataLayer.DownloadFields.WindowsVista:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.WindowsVistaColumnDESC);
					else
						Sort(Download.SortBy.WindowsVistaColumnASC);
					break;
				case DataLayer.DownloadFields.Windows7:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.Windows7ColumnDESC);
					else
						Sort(Download.SortBy.Windows7ColumnASC);
					break;
				case DataLayer.DownloadFields.Linux:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.LinuxColumnDESC);
					else
						Sort(Download.SortBy.LinuxColumnASC);
					break;
				case DataLayer.DownloadFields.Unix:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.UnixColumnDESC);
					else
						Sort(Download.SortBy.UnixColumnASC);
					break;
				case DataLayer.DownloadFields.WindowsMobile:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.WindowsMobileColumnDESC);
					else
						Sort(Download.SortBy.WindowsMobileColumnASC);
					break;
				case DataLayer.DownloadFields.iPhone:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.iPhoneColumnDESC);
					else
						Sort(Download.SortBy.iPhoneColumnASC);
					break;
				case DataLayer.DownloadFields.ScreenReader:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.ScreenReaderColumnDESC);
					else
						Sort(Download.SortBy.ScreenReaderColumnASC);
					break;
				case DataLayer.DownloadFields.RequiresSilverlight:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.RequiresSilverlightColumnDESC);
					else
						Sort(Download.SortBy.RequiresSilverlightColumnASC);
					break;
				case DataLayer.DownloadFields.RequiresFlash:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.RequiresFlashColumnDESC);
					else
						Sort(Download.SortBy.RequiresFlashColumnASC);
					break;
				case DataLayer.DownloadFields.RequiresDotNet:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.RequiresDotNetColumnDESC);
					else
						Sort(Download.SortBy.RequiresDotNetColumnASC);
					break;
				case DataLayer.DownloadFields.DotNetVersion:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.DotNetVersionColumnDESC);
					else
						Sort(Download.SortBy.DotNetVersionColumnASC);
					break;
				case DataLayer.DownloadFields.RequiresMono:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.RequiresMonoColumnDESC);
					else
						Sort(Download.SortBy.RequiresMonoColumnASC);
					break;
				case DataLayer.DownloadFields.RequiresMoonlight:
					if (sortDirection == SortDirection.Descending)
						Sort(Download.SortBy.RequiresMoonlightColumnDESC);
					else
						Sort(Download.SortBy.RequiresMoonlightColumnASC);
					break;

            }
        }

        public int PageCount(int pageSize)
        {
            int pageCount = this.Count / pageSize;
            if ((int)(this.Count / pageSize * pageSize) == this.Count)
                return pageCount;
            else
                return pageCount + 1;
        }

        public List<Textfyre.TextfyreWeb.BusinessLayer.Download> GetPage(int pageSize, int pageNumber)
        {
            int beginIndex = ((pageNumber - 1) * pageSize); // start at 0 so pages are offset -1
            int endIndex = beginIndex + pageSize - 1;

            List<Textfyre.TextfyreWeb.BusinessLayer.Download> returnCollection = new List<Textfyre.TextfyreWeb.BusinessLayer.Download>();

            for (int row = beginIndex; row < endIndex; row++)
            {
                returnCollection.Add(this[row]);
            }

            return returnCollection;
        }
    }

}
