@model Zifmia.Model.ZifmiaViewModel

@using Zifmia.Model;

<script type="text/javascript">

    var game = new Game();

    $(document).ready(function () {

        $("#mapButton").click(function () {
            $("#gameMap").bPopup();
        });

        $("#hintsButton").click(function () {
            $("#hintsBlock").bPopup();
        });

        $('html, body').animate({ scrollTop: '0px' }, 800);

        $("#logoutButton").click(function () {
            zifmia.authKey = "";
            zifmia.saveSessionData();
            document.location.href = "/";
        });

    });

    function setupAnykey() {
        $("#anyKey").focus();
    }

    function onCommandEnter(e) {
        if (e.which == 13) {
            handleCommand();
        }
    }

    function handleCommand() {
        var command = $("#userCommand").val();

        zifmia.sendCommand(game.sessionKey, game.branchId, game.turn, command, handleSendCommand, handleSendCommandError);

        $("#userCommand").val("");
    }

    var skipToggle = 0;

    function toggleQuestion(answers) {

        var a = document.getElementById(answers.id);

        if (skipToggle == 0) {
            if (a.style.display == 'none') {
                a.style.display = 'block';
            } else {
                a.style.display = 'none';
            }
        }

        skipToggle = 0;
    }

    function showHint(mungedText, hintText) {
        mungedText.style.display = 'none';
        hintText.style.display = 'block';
        skipToggle = 1;
    }
</script>

@{
    ZifmiaLoggedInViewData loggedInData = new ZifmiaLoggedInViewData();
    loggedInData.Nickname = Model.Player.NickName;
    loggedInData.GameTitle = Model.Game.Title;
}

<!DOCTYPE html>
<html>
<head>
    <title>Textfyre Adaptive Learning Entertainment: Interactive Stories, Puzzles, and Brain
        Teasers</title>
    <link href="@Url.Content("~/Scripts/themes/base/jquery.ui.all.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.7.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.16.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/ui/jquery.ui.core.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/ui/jquery.ui.widget.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/ui/jquery.ui.tabs.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/cookies.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/utility.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.bpopup-0.5.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/utility.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/zifmia-htmlformatting.js")" type="text/javascript"></script>
</head>
<body style="padding: 0 0 0 0;margin: 0 0 0 0;">
    <div id="headerPanel">
        @Html.Partial("SessionLoggedIn", loggedInData)
        @Html.Partial("TitleContent", Model)
        @Html.Partial("ChapterContent", Model)
        </div>
    <div id="contentPanel">
        <div id="mainPanel">
            @Html.Partial("MainContent", Model)
        </div>
    </div>
    <div id="commandPanel">
        @Html.Partial("CommandContent", Model)
    </div>
</body>
</html>

